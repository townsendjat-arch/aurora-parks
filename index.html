  <!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aurora Parks Finder ‚Äî Mighty Dads</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<style>
  :root {
    --grass: #3d6b4a; --grass-light: #5a8f6a; --earth: #b07848;
    --sky: #c8dff0; --ink: #1a1a1a; --mist: #f0ede8; --white: #ffffff;
    --md-orange: #e8703a;
    --shadow: 0 2px 12px rgba(0,0,0,0.07);
    --shadow-hover: 0 8px 28px rgba(0,0,0,0.15);
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'DM Sans', sans-serif; background: var(--mist); color: var(--ink); min-height: 100vh; }
  header { background: var(--grass); padding: 28px 24px 44px; position: relative; overflow: hidden; }
  header::after { content: ''; position: absolute; bottom: -2px; left: -5%; right: -5%; height: 36px; background: var(--mist); border-radius: 50% 50% 0 0 / 100% 100% 0 0; }
  .header-inner { max-width: 1100px; margin: 0 auto; display: flex; align-items: flex-start; justify-content: space-between; gap: 16px; flex-wrap: wrap; position: relative; z-index: 1; }
  .header-left { display: flex; flex-direction: column; gap: 6px; }
  h1 { font-family: 'Syne', sans-serif; font-size: clamp(28px,4vw,48px); font-weight: 800; color: var(--white); line-height: 1; letter-spacing: -0.5px; }
  .subtitle { font-size: 13px; color: rgba(255,255,255,0.65); font-weight: 300; }
  .park-count { display: inline-flex; align-items: center; gap: 6px; background: rgba(255,255,255,0.12); border: 1px solid rgba(255,255,255,0.2); border-radius: 100px; padding: 4px 12px; font-size: 12px; color: rgba(255,255,255,0.85); width: fit-content; margin-top: 4px; }
  .md-badge { display: flex; flex-direction: column; align-items: flex-end; gap: 6px; text-decoration: none; }
  .md-label { font-size: 10px; color: rgba(255,255,255,0.5); letter-spacing: 0.08em; text-transform: uppercase; }
  .md-logo { background: var(--white); border-radius: 10px; padding: 8px 16px; box-shadow: 0 2px 12px rgba(0,0,0,0.2); }
  .md-logo img { height: 36px; width: auto; display: block; }
  .sticky { background: var(--white); border-bottom: 1px solid #e8e4de; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 16px rgba(0,0,0,0.05); }
  .top-controls { max-width: 1100px; margin: 0 auto; padding: 14px 20px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
  .search-wrap { position: relative; flex: 1; min-width: 180px; }
  .search-wrap svg { position: absolute; left: 11px; top: 50%; transform: translateY(-50%); opacity: 0.38; pointer-events: none; }
  #search { width: 100%; padding: 9px 12px 9px 36px; border: 1.5px solid #ddd; border-radius: 8px; font-family: 'DM Sans', sans-serif; font-size: 14px; background: var(--mist); outline: none; transition: border-color 0.18s; }
  #search:focus { border-color: var(--grass); background: var(--white); }
  #sort { padding: 9px 30px 9px 13px; border: 1.5px solid #ddd; border-radius: 8px; font-family: 'DM Sans', sans-serif; font-size: 13px; background: var(--mist) url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1l4 4 4-4' stroke='%23777' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E") no-repeat right 11px center; appearance: none; outline: none; cursor: pointer; }
  .filter-bar { max-width: 1100px; margin: 0 auto; padding: 0 20px 12px; display: flex; gap: 6px; flex-wrap: wrap; align-items: center; }
  .filter-label { font-size: 11px; font-weight: 500; color: #999; text-transform: uppercase; letter-spacing: 0.07em; flex-shrink: 0; }
  .pill { padding: 5px 12px; border-radius: 100px; border: 1.5px solid #ddd; background: transparent; font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 500; color: #555; cursor: pointer; transition: all 0.14s; white-space: nowrap; line-height: 1; }
  .pill:hover { border-color: var(--grass); color: var(--grass); }
  .pill.on { background: var(--grass); border-color: var(--grass); color: var(--white); }
  .pill.reset { color: #bbb; border-color: transparent; font-size: 11px; }
  .pill.reset:hover { color: var(--ink); border-color: #ddd; }
  main { max-width: 1100px; margin: 0 auto; padding: 24px 20px 64px; }
  /* MAP */
  .map-section { background: var(--white); border-radius: 14px; box-shadow: var(--shadow); overflow: hidden; margin-bottom: 20px; }
  .map-header { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; border-bottom: 1px solid #e8e4de; flex-wrap: wrap; gap: 8px; }
  .map-title { font-family: 'Syne', sans-serif; font-size: 14px; font-weight: 700; display: flex; align-items: center; gap: 6px; }
  .map-controls { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
  .map-btn { padding: 5px 12px; border-radius: 8px; border: 1.5px solid #ddd; background: transparent; font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 500; color: #555; cursor: pointer; transition: all 0.14s; display: flex; align-items: center; gap: 5px; }
  .map-btn:hover { border-color: var(--grass); color: var(--grass); }
  .map-btn.active { background: var(--grass); border-color: var(--grass); color: white; }
  #map { height: 400px; }
  .map-legend { padding: 8px 16px; border-top: 1px solid #e8e4de; display: flex; gap: 16px; flex-wrap: wrap; align-items: center; font-size: 11px; color: #999; }
  .legend-item { display: flex; align-items: center; gap: 5px; }
  .legend-dot { width: 10px; height: 10px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 0 1px rgba(0,0,0,0.15); flex-shrink: 0; }
  /* CARDS */
  .meta { font-size: 12px; color: #aaa; font-style: italic; margin-bottom: 16px; }
  .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 18px; }
  .card { background: var(--white); border-radius: 14px; box-shadow: var(--shadow); display: flex; flex-direction: column; transition: box-shadow 0.18s, transform 0.18s; animation: up 0.28s ease both; overflow: hidden; }
  .card:hover { box-shadow: var(--shadow-hover); transform: translateY(-3px); }
  @keyframes up { from { opacity:0; transform:translateY(7px); } to { opacity:1; transform:translateY(0); } }
  .photo-gallery { position: relative; width: 100%; aspect-ratio: 16/9; overflow: hidden; }
  .photo-gallery img.park-photo { width: 100%; height: 100%; object-fit: cover; display: block; }
  .placeholder { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 8px; }
  .placeholder-icon { font-size: 38px; opacity: 0.45; }
  .placeholder-text { font-size: 11px; color: #999; font-style: italic; }
  .passport-btn { position: absolute; top: 8px; left: 8px; background: rgba(255,255,255,0.9); border: none; border-radius: 6px; padding: 4px 9px; font-size: 11px; font-weight: 600; cursor: pointer; font-family: 'DM Sans', sans-serif; display: flex; align-items: center; gap: 4px; transition: all 0.15s; color: #555; }
  .passport-btn:hover { background: white; color: var(--grass); }
  .passport-btn.stamped { background: var(--grass); color: white; }
  .map-pin-btn { position: absolute; top: 8px; right: 8px; background: rgba(255,255,255,0.9); border: none; border-radius: 6px; padding: 4px 9px; font-size: 11px; font-weight: 600; cursor: pointer; font-family: 'DM Sans', sans-serif; display: flex; align-items: center; gap: 4px; transition: all 0.15s; color: #555; }
  .map-pin-btn:hover { background: white; color: var(--md-orange); }
  .card-body { padding: 14px 16px 16px; display: flex; flex-direction: column; gap: 9px; flex: 1; }
  .card-head { display: flex; justify-content: space-between; align-items: flex-start; gap: 6px; }
  .park-name { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; line-height: 1.3; color: var(--ink); }
  .acres { font-size: 11px; color: #bbb; white-space: nowrap; padding-top: 2px; flex-shrink: 0; }
  .addr { font-size: 12px; color: #999; display: flex; align-items: flex-start; gap: 5px; }
  .addr svg { flex-shrink: 0; margin-top: 1px; opacity: 0.6; }
  .tags { display: flex; flex-wrap: wrap; gap: 5px; }
  .tag { font-size: 11px; padding: 3px 9px; border-radius: 100px; background: rgba(0,0,0,0.055); color: #555; font-weight: 500; }
  .tag.hi { background: rgba(61,107,74,0.13); color: var(--grass); }
  .tag.none { color: #ccc; font-style: italic; }
  .card-actions { display: flex; gap: 8px; margin-top: auto; padding-top: 4px; }
  .dir-btn { flex: 1; display: flex; align-items: center; justify-content: center; gap: 5px; padding: 9px; border-radius: 8px; background: var(--grass); color: var(--white); border: none; font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 500; text-decoration: none; cursor: pointer; transition: background 0.14s; }
  .dir-btn:hover { background: #2e5238; }
  .city-btn { display: flex; align-items: center; justify-content: center; gap: 4px; padding: 9px 12px; border-radius: 8px; background: transparent; color: #999; border: 1.5px solid #e0ddd8; font-family: 'DM Sans', sans-serif; font-size: 12px; font-weight: 500; text-decoration: none; cursor: pointer; transition: all 0.14s; white-space: nowrap; }
  .city-btn:hover { border-color: var(--grass); color: var(--grass); }
  .match-badge { font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 100px; white-space: nowrap; }
  .match-badge.perfect { background: rgba(61,107,74,0.13); color: var(--grass); }
  .match-badge.partial { background: rgba(176,120,72,0.12); color: var(--earth); }
  .match-badge.none-match { background: rgba(0,0,0,0.05); color: #ccc; }
  .card.dimmed { opacity: 0.42; }
  .passport-bar { background: var(--white); border-bottom: 1px solid #e8e4de; padding: 10px 20px; }
  .passport-inner { max-width: 1100px; margin: 0 auto; display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
  .passport-title { font-family: 'Syne', sans-serif; font-size: 13px; font-weight: 700; }
  .passport-count { background: var(--grass); color: white; border-radius: 100px; padding: 2px 10px; font-size: 12px; font-weight: 600; }
  .passport-progress { flex: 1; min-width: 120px; height: 6px; background: #e8e4de; border-radius: 3px; overflow: hidden; }
  .passport-fill { height: 100%; background: var(--grass); border-radius: 3px; transition: width 0.3s ease; }
  .passport-msg { font-size: 12px; color: #aaa; }
  .empty { text-align: center; padding: 80px 20px; color: #ccc; }
  .empty .ico { font-size: 42px; margin-bottom: 10px; }
  .empty h3 { font-family: 'Syne', sans-serif; font-size: 17px; color: #ccc; margin-bottom: 5px; }
  footer { background: var(--grass); color: rgba(255,255,255,0.6); text-align: center; padding: 28px 20px; font-size: 12px; }
  footer a { color: rgba(255,255,255,0.9); text-decoration: none; font-weight: 600; }
  footer a:hover { text-decoration: underline; }
  .footer-logo img { height: 32px; width: auto; filter: brightness(0) invert(1); margin-bottom: 8px; }
  .leaflet-popup-content { font-family: 'DM Sans', sans-serif; font-size: 13px; line-height: 1.5; min-width: 160px; }
  .leaflet-popup-content b { font-family: 'Syne', sans-serif; font-size: 14px; display: block; margin-bottom: 3px; }
  .popup-acres { font-size: 11px; color: #aaa; }
  .popup-visited { display: inline-block; margin-top: 6px; font-size: 11px; font-weight: 600; background: rgba(61,107,74,0.13); color: var(--grass); padding: 2px 8px; border-radius: 100px; }
</style>
</head>
<body>
<header>
  <div class="header-inner">
    <div class="header-left">
      <h1>Aurora Parks Finder</h1>
      <div class="subtitle">City of Aurora, Colorado</div>
      <div class="park-count">&#127794; <span id="tot">0</span> parks &amp; open spaces</div>
    </div>
    <a href="https://mightydads.org" target="_blank" class="md-badge">
      <span class="md-label">Brought to you by</span>
      <div class="md-logo"><img src="./0.png" alt="Mighty Dads"></div>
    </a>
  </div>
</header>
<div class="passport-bar">
  <div class="passport-inner">
    <span>&#127957;&#65039;</span>
    <span class="passport-title">Park Passport</span>
    <span class="passport-count" id="passport-count">0 visited</span>
    <div class="passport-progress"><div class="passport-fill" id="passport-fill" style="width:0%"></div></div>
    <span class="passport-msg" id="passport-msg">Check in at parks you've visited!</span>
  </div>
</div>
<div class="sticky">
  <div class="top-controls">
    <div class="search-wrap">
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="text" id="search" placeholder="Search by name or address&#x2026;">
    </div>
    <select id="sort">
      <option value="alpha">A &#x2192; Z</option>
      <option value="big">Largest first</option>
      <option value="small">Smallest first</option>
      <option value="nearest">Nearest first</option>
      <option value="visited">Visited first</option>
    </select>
    <div id="shown-badge" style="font-size:12px;color:#aaa;white-space:nowrap;">0 shown</div>
  </div>
  <div class="filter-bar" id="filter-bar">
    <span class="filter-label">Filter:</span>
  </div>
</div>
<main>
  <div class="map-section">
    <div class="map-header">
      <div class="map-title">&#x1F5FA;&#xFE0F; Park Map</div>
      <div class="map-controls">
        <button class="map-btn" id="btn-locate" onclick="locateMe()">&#x1F4CD; Find me</button>
        <span id="locate-error" style="display:none;font-size:11px;color:#e8703a;font-weight:500;">‚ö†Ô∏è Location access denied ‚Äî enable in browser settings</span>
        <button class="map-btn active" id="btn-show-all" onclick="setMapMode('all')">All parks</button>
        <button class="map-btn" id="btn-show-filtered" onclick="setMapMode('filtered')">Filtered only</button>
        <button class="map-btn" id="btn-show-visited" onclick="setMapMode('visited')">Visited only</button>
      </div>
    </div>
    <div id="map"></div>
    <div class="map-legend">
      <span class="legend-item"><span class="legend-dot" style="background:#3d6b4a"></span> Park</span>
      <span class="legend-item"><span class="legend-dot" style="background:#e8703a"></span> Visited</span>
      <span class="legend-item"><span class="legend-dot" style="background:#c8a000"></span> Filter match</span>
      <span class="legend-item"><span class="legend-dot" style="background:#4285f4"></span> You</span>
      <span id="legend-dist" style="margin-left:auto;color:#bbb;font-size:11px;"></span>
    </div>
  </div>
  <div class="meta" id="meta"></div>
  <div class="grid" id="grid"></div>
  <div class="empty" id="empty" style="display:none">
    <div class="ico">&#127794;</div>
    <h3>No parks found</h3>
    <p>Try different search terms or clear some filters.</p>
  </div>
</main>
<footer>
  <div class="footer-logo"><img src="./0.png" alt="Mighty Dads"></div>
  <div>Building community for dads in Aurora, Colorado &mdash; <a href="https://mightydads.org" target="_blank">mightydads.org</a></div>
  <div style="margin-top:6px;opacity:0.6;">Park data sourced from the <a href="https://www.auroragov.org" target="_blank">City of Aurora</a></div>
</footer>
<script>
const COORDS = {
  "Alta Vista Park": [39.690588,-104.791457],
  "Altura Park": [39.742784,-104.813072],
  "Anchor Point Park": [39.592131,-104.676356],
  "Apache Mesa Park": [39.72773,-104.799267],
  "Appaloosa Park": [39.614964,-104.707423],
  "Aqua Vista Park": [39.628431,-104.7698],
  "Arapahoe Little League Complex": [39.699921,-104.790377],
  "Aurora Hills Golf Course": [39.717047,-104.836477],
  "Aurora Reservoir": [39.594941,-104.661717],
  "Bellewood Park": [39.62528,-104.785948],
  "Bicentennial Park": [39.714069,-104.832475],
  "Blue Grama Grass Park": [39.656322,-104.751684],
  "Canterbury Park": [39.692003,-104.860246],
  "Carson Park": [39.641355,-104.82353],
  "Centre Hills Park": [39.714523,-104.80067],
  "CentrePointe Park": [39.702523,-104.793197],
  "Cherry Creek Spillway": [39.662947,-104.818635],
  "City Center Park": [39.71249,-104.816752],
  "City Park": [39.742856,-104.874314],
  "Coal Creek Arena": [39.72405,-104.751584],
  "Cottonwood Grove": null,
  "Cottonwood Park": [39.754091,-104.825453],
  "Country Lane Park": [39.684745,-104.870806],
  "Crestridge Park": [39.668023,-104.815967],
  "Del Mar Park": [39.724436,-104.846784],
  "DeLaney Farm": [39.713248,-104.805816],
  "Eagle Park": [39.658242,-104.815445],
  "Eldorado Park": [39.662606,-104.785521],
  "Expo Park": [39.705567,-104.860337],
  "Fairplay Park": [39.749457,-104.814135],
  "Flanders Park": [39.661618,-104.758744],
  "Fletcher Park": [39.733065,-104.883196],
  "Fletcher Plaza": [39.739849,-104.873959],
  "Freedom Park": [39.736317,-104.828513],
  "Fulton Park": [39.728114,-104.872223],
  "Generals Park": [39.74142,-104.845855],
  "Golden Eagle Park": [39.589938,-104.713297],
  "Grandview Dog Park": [39.636759,-104.784578],
  "Great Plains Park": [39.679858,-104.755732],
  "Hampden Run Park": [39.652712,-104.777687],
  "Havana Heights Park": [39.67679,-104.861032],
  "Havana Heights Pond Park": [39.681466,-104.859682],
  "Havana Park": [39.732315,-104.863757],
  "Highland Hollows Park": [39.691816,-104.776803],
  "Highline Park & Ballfields": null,
  "Hilltop Park": [39.655852,-104.78663],
  "Hoffman Park": [39.728089,-104.841423],
  "Homestead Park": [39.68995,-104.708268],
  "Hoops Park": [39.724956,-104.798072],
  "Horizon Park": [39.64534,-104.772435],
  "Horseshoe Park": [39.679568,-104.800075],
  "Jewell Park": [39.736668,-104.845475],
  "Jewell Wetlands": [39.683077,-104.836801],
  "Kalispell Park Ballfields": [39.631889,-104.803136],
  "Kestrel Point Natural Area": [39.583631,-104.703013],
  "Kingsborough Park": [39.689563,-104.806187],
  "La Parquita Park": [39.643019,-104.796793],
  "Larkspur Park": [39.589767,-104.725698],
  "Los Ninos Park": [39.645483,-104.804967],
  "Lowry Park": [39.731604,-104.877552],
  "Marina Park": [39.627199,-104.779407],
  "McMullen Park": [39.720009,-104.872917],
  "Meadow Hills Golf Course": [39.64768,-104.82099],
  "Meadowood Park": [39.660507,-104.798171],
  "Mission Viejo Park": [39.646806,-104.797755],
  "Montview Park": [39.745523,-104.880075],
  "Moorhead Park": [39.751997,-104.865959],
  "Mountain View Park": [39.699053,-104.787079],
  "Murphy Creek Golf Course": [39.680419,-104.711844],
  "Nome Park": [39.734064,-104.851523],
  "Norfolk Glen Park": [39.746622,-104.804208],
  "Olympic Neighborhood Park": [39.669435,-104.804601],
  "Olympic Park Ballfields": [39.666749,-104.808591],
  "Olympic Park Volleyball": [39.670335,-104.805318],
  "Pagosa Park": [39.664834,-104.788167],
  "Panorama Park": [39.693709,-104.786461],
  "Parklane Park": [39.759814,-104.837669],
  "Peoria Hills Park": [39.690863,-104.843266],
  "Pheasant Run Park": [39.636701,-104.813993],
  "Plains Conservation Center": [39.672398,-104.732622],
  "Ponderosa Preserve": [39.568795,-104.700518],
  "Pronghorn Natural Area": [39.63221,-104.667427],
  "Quincy Reservoir": [39.632228,-104.763813],
  "Red-tailed Hawk Park": [39.582314,-104.71349],
  "Rocky Ridge Park": [39.695873,-104.799086],
  "Saddle Rock Golf Course": [39.588199,-104.738403],
  "Sagebrush Park": [39.630175,-104.818099],
  "Sand Creek Park": [39.755801,-104.840753],
  "Sand Creek Riparian Preserve": null,
  "Settlers Park": [39.702134,-104.815823],
  "Seven Hills Park": [39.661756,-104.764025],
  "Sidecreek Park": [39.684314,-104.764114],
  "Singletree Park": [39.801454,-104.758465],
  "Soccer Skills Area": [39.654008,-104.753898],
  "Spencer Garrett Park": [39.743049,-104.860022],
  "Sports Park": [39.734999,-104.761396],
  "Springhill Golf Course": [39.732869,-104.779094],
  "Springhill Park": [39.730395,-104.780852],
  "Star K Ranch": [39.748673,-104.798532],
  "Summer Valley Park": [39.6478,-104.784517],
  "Sunburst Park": [39.635953,-104.799016],
  "Sunrise Park": [39.642691,-104.757186],
  "Switchgrass Park": [39.668404,-104.752372],
  "Terrace Park": [39.748146,-104.768015],
  "Tierra Park": [39.681325,-104.8148],
  "Tollgate Crossing Neighborhood Park": [39.628145,-104.708543],
  "Toll Gate Park": [39.702392,-104.804222],
  "Traditions Neighborhood Park": [39.71534,-104.691805],
  "Triangle Park": [39.742039,-104.759874],
  "Upland Park": [39.756492,-104.775638],
  "Utah Park": [39.683831,-104.842879],
  "Village East Park": [39.691923,-104.85303],
  "Village Green Park": [39.692763,-104.814144],
  "Virginia Court Park": [39.705696,-104.840426],
  "Wagon Trail Park": [39.631724,-104.795486],
  "Wheel Park": [39.671393,-104.806083],
  "Wheeling Park": [39.703522,-104.83104],
  "Willow Bend Park": [39.657365,-104.74796],
};

let visited = new Set(JSON.parse(localStorage.getItem(‚Äòmd_visited‚Äô) || ‚Äò[]‚Äô));
let userLat = null, userLng = null;
let mapMode = ‚Äòall‚Äô;
let map, markersLayer, userMarker;
let currentFiltered = [];

function initMap() {
map = L.map(‚Äúmap‚Äù).setView([39.710, -104.800], 11);
L.tileLayer(‚Äúhttps://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png‚Äù, {
maxZoom: 19, attribution: ‚Äú¬© OpenStreetMap contributors‚Äù
}).addTo(map);
markersLayer = L.layerGroup().addTo(map);
}

function renderMarkers(filteredList) {
if (!markersLayer) return;
markersLayer.clearLayers();
const filteredNames = new Set(filteredList.map(p => p.n));
const hasFilters = window._activeSet && window._activeSet.size > 0;

let toShow = P.filter(p => {
const c = COORDS[p.n];
if (!c) return false;
if (mapMode === ‚Äòfiltered‚Äô) return filteredNames.has(p.n);
if (mapMode === ‚Äòvisited‚Äô) return visited.has(p.n);
return true;
});

toShow.forEach(p => {
const c = COORDS[p.n];
const isVisited = visited.has(p.n);
const isMatch = filteredNames.has(p.n) && hasFilters;
const color = isVisited ? ‚Äò#e8703a‚Äô : isMatch ? ‚Äò#c8a000‚Äô : ‚Äò#3d6b4a‚Äô;
const r = isVisited || isMatch ? 8 : 6;
L.circleMarker([c[0], c[1]], {
radius: r, fillColor: color, color: ‚Äòwhite‚Äô, weight: 2, fillOpacity: 0.88
}).bindPopup(
‚Äò<b>‚Äô + p.n + ‚Äò</b>‚Äô +
‚Äò<div class="popup-acres">‚Äô + (p.ac > 0 ? p.ac.toLocaleString() + ‚Äô acres‚Äô : ‚ÄòOpen space‚Äô) + ‚Äò</div>‚Äô +
‚Äò<div style="font-size:11px;color:#999;margin-top:2px">‚Äô + p.a + ‚Äò, Aurora CO</div>‚Äô +
(isVisited ? ‚Äò<div class="popup-visited">‚úì Visited</div>‚Äô : ‚Äò‚Äô)
).addTo(markersLayer);
});
}

function focusMapOnPark(name) {
const c = COORDS[name];
if (!c) return;
map.setView([c[0], c[1]], 15, { animate: true });
document.querySelector(‚Äô.map-section‚Äô).scrollIntoView({ behavior: ‚Äòsmooth‚Äô, block: ‚Äòstart‚Äô });
markersLayer.eachLayer(layer => {
if (layer.getLatLng) {
const ll = layer.getLatLng();
if (Math.abs(ll.lat - c[0]) < 0.0002 && Math.abs(ll.lng - c[1]) < 0.0002) {
layer.openPopup();
}
}
});
}

function setMapMode(mode) {
mapMode = mode;
document.querySelectorAll(‚Äô.map-btn[id^=‚Äúbtn-show‚Äù]‚Äô).forEach(b => b.classList.remove(‚Äòactive‚Äô));
document.getElementById(‚Äòbtn-show-‚Äô + mode).classList.add(‚Äòactive‚Äô);
renderMarkers(currentFiltered);
}

function locateMe() {
if (!navigator.geolocation) { alert(‚ÄúGeolocation not supported.‚Äù); return; }
const btn = document.getElementById(‚Äòbtn-locate‚Äô);
btn.textContent = ‚Äò‚è≥ Locating‚Ä¶‚Äô;
navigator.geolocation.getCurrentPosition(pos => {
userLat = pos.coords.latitude;
userLng = pos.coords.longitude;
btn.innerHTML = ‚Äòüìç Located!‚Äô;
btn.classList.add(‚Äòactive‚Äô);
setTimeout(() => { btn.innerHTML = ‚Äòüìç Find me‚Äô; btn.classList.remove(‚Äòactive‚Äô); }, 2500);
if (userMarker) map.removeLayer(userMarker);
userMarker = L.circleMarker([userLat, userLng], {
radius: 9, fillColor: ‚Äò#4285f4‚Äô, color: ‚Äòwhite‚Äô, weight: 2.5, fillOpacity: 1
}).bindPopup(‚Äô<b>You are here</b>‚Äô).addTo(map);
map.setView([userLat, userLng], 13, { animate: true });
document.getElementById(‚Äòlegend-dist‚Äô).textContent = ‚ÄòDistances from your location‚Äô;
if (document.getElementById(‚Äòsort‚Äô).value === ‚Äònearest‚Äô) render();
else renderMarkers(currentFiltered);
}, () => { btn.innerHTML = ‚Äòüìç Find me‚Äô; alert(‚ÄúCouldn‚Äôt get your location.‚Äù); });
}

function haversine(lat1, lng1, lat2, lng2) {
const R = 3958.8;
const dLat = (lat2-lat1)*Math.PI/180;
const dLng = (lng2-lng1)*Math.PI/180;
const a = Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLng/2)**2;
return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
}

function distLabel(m) {
if (m < 0.1) return ‚Äò<0.1 mi‚Äô;
if (m < 10) return m.toFixed(1) + ‚Äô mi‚Äô;
return Math.round(m) + ‚Äô mi‚Äô;
}

function saveVisited() {
localStorage.setItem(‚Äòmd_visited‚Äô, JSON.stringify([‚Ä¶visited]));
updatePassport();
renderMarkers(currentFiltered);
}

function updatePassport() {
const count = visited.size, total = P.length;
document.getElementById(‚Äòpassport-count‚Äô).textContent = count + ‚Äô visited‚Äô;
document.getElementById(‚Äòpassport-fill‚Äô).style.width = (count/total*100) + ‚Äò%‚Äô;
const msg = count===0 ? ‚ÄúCheck in at parks you‚Äôve visited!‚Äù
: count<10 ? (total-count) + ‚Äô parks still to explore!‚Äô
: count<25 ? ‚ÄúYou‚Äôre getting out there! üåø‚Äù
: count<50 ? ‚ÄòMighty explorer! üèïÔ∏è‚Äô
: ‚ÄòAurora Parks Legend! üèÜ‚Äô;
document.getElementById(‚Äòpassport-msg‚Äô).innerHTML = msg;
}

const GRADIENTS = [
[‚Äô#d4ead9‚Äô,‚Äô#c8dff0‚Äô],[‚Äô#c8dff0‚Äô,‚Äô#d4ead9‚Äô],[‚Äô#e8d5c0‚Äô,‚Äô#d4ead9‚Äô],
[‚Äô#d4ead9‚Äô,‚Äô#e8d5c0‚Äô],[‚Äô#c8e8d4‚Äô,‚Äô#b8d4e8‚Äô],[‚Äô#e8e0d4‚Äô,‚Äô#c8ead4‚Äô],
[‚Äô#d8e8c8‚Äô,‚Äô#c0d8e8‚Äô],[‚Äô#e0d8c8‚Äô,‚Äô#d0e8d0‚Äô],
];
const PLACEHOLDER_ICONS = [‚Äôüå≤‚Äô,‚Äôüå≥‚Äô,‚ÄôüåûÔ∏è‚Äô,‚Äôüåø‚Äô,‚ÄôüçÉ‚Äô,‚Äô‚õ≤‚Äô,‚Äôüåª‚Äô,‚Äôüåæ‚Äô,‚ÄôüèïÔ∏è‚Äô,‚ÄôüåÑ‚Äô];

const P = [
{n:‚ÄúAlta Vista Park‚Äù,a:‚Äú16800 E. Idaho Cir.‚Äù,ac:1.5,f:{},photos:[]},
{n:‚ÄúAltura Park‚Äù,a:‚Äú15100 E. 17th Ave.‚Äù,ac:3.9,f:{playground:1,baseball:1},photos:[]},
{n:‚ÄúAnchor Point Park‚Äù,a:‚Äú6855 S. Robertsdale Way‚Äù,ac:5,f:{playground:1,shelter:1},photos:[]},
{n:‚ÄúApache Mesa Park‚Äù,a:‚Äú710 N. Laredo St.‚Äù,ac:3,f:{playground:1,restroom:1},photos:[]},
{n:‚ÄúAppaloosa Park‚Äù,a:‚Äú5575 S. De Gaulle St.‚Äù,ac:6.7,f:{playground:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúAqua Vista Park‚Äù,a:‚Äú18700 E. Wagon Trail Cir.‚Äù,ac:12.1,f:{tennis:1,playground:1,basketball:1,pool:1,shelter:1},photos:[]},
{n:‚ÄúArapahoe Little League Complex‚Äù,a:‚Äú16900 E. Kentucky Ave.‚Äù,ac:14,f:{baseball:1},photos:[]},
{n:‚ÄúAurora Hills Golf Course‚Äù,a:‚Äú50 S. Peoria St.‚Äù,ac:148,f:{golf:1},photos:[]},
{n:‚ÄúAurora Reservoir‚Äù,a:‚Äú5800 S. Powhaton Rd.‚Äù,ac:1861.5,f:{playground:1,fishing:1,trails:1,restroom:1,shelter:1,boating:1},photos:[]},
{n:‚ÄúBellewood Park‚Äù,a:‚Äú17427 E. Bellewood Cir.‚Äù,ac:2.2,f:{playground:1},photos:[]},
{n:‚ÄúBicentennial Park‚Äù,a:‚Äú13655 E. Alameda Ave.‚Äù,ac:35.3,f:{dog_park:1,shelter:1},photos:[]},
{n:‚ÄúBlue Grama Grass Park‚Äù,a:‚Äú3323 S. Jericho Way‚Äù,ac:1,f:{playground:1,shelter:1},photos:[]},
{n:‚ÄúCanterbury Park‚Äù,a:‚Äú1400 S. Joliet St.‚Äù,ac:7.4,f:{playground:1},photos:[]},
{n:‚ÄúCarson Park‚Äù,a:‚Äú14000 E. Oxford Pl.‚Äù,ac:7.9,f:{playground:1},photos:[]},
{n:‚ÄúCentre Hills Park‚Äù,a:‚Äú16300 E. Centretech Pkwy.‚Äù,ac:43.9,f:{disc_golf:1},photos:[]},
{n:‚ÄúCentrePointe Park‚Äù,a:‚Äú16298 E. Exposition Dr.‚Äù,ac:24.5,f:{playground:1,shelter:1},photos:[]},
{n:‚ÄúCherry Creek Spillway‚Äù,a:‚Äú2799 S. Chambers Rd.‚Äù,ac:364.5,f:{trails:1},photos:[]},
{n:‚ÄúCity Center Park‚Äù,a:‚Äú14701 E. Alameda Ave.‚Äù,ac:8.5,f:{trails:1},photos:[]},
{n:‚ÄúCity Park‚Äù,a:‚Äú9701 E. 16th Ave.‚Äù,ac:5.3,f:{playground:1,basketball:1,skate:1},photos:[]},
{n:‚ÄúCoal Creek Arena‚Äù,a:‚Äú20255 E. 6th Ave.‚Äù,ac:10,f:{trails:1},photos:[]},
{n:‚ÄúCottonwood Grove‚Äù,a:‚Äú1500 S. Peoria St.‚Äù,ac:0.3,f:{trails:1},photos:[]},
{n:‚ÄúCottonwood Park‚Äù,a:‚Äú14000 E. 26th Ave.‚Äù,ac:7.7,f:{playground:1,basketball:1,shelter:1},photos:[]},
{n:‚ÄúCountry Lane Park‚Äù,a:‚Äú10055 E. Colorado Ave.‚Äù,ac:4.3,f:{playground:1,basketball:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúCrestridge Park‚Äù,a:‚Äú14751 E. Yale Ave.‚Äù,ac:2,f:{pickleball:1,playground:1,shelter:1},photos:[]},
{n:‚ÄúDel Mar Park‚Äù,a:‚Äú12000 E. 6th Ave.‚Äù,ac:39.9,f:{tennis:1,playground:1,basketball:1,baseball:1,pool:1,volleyball:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúDeLaney Farm‚Äù,a:‚Äú170 S. Chambers Rd.‚Äù,ac:113.8,f:{trails:1,garden:1},photos:[]},
{n:‚ÄúEagle Park‚Äù,a:‚Äú14691 E. Floyd Ave.‚Äù,ac:6.5,f:{playground:1,basketball:1},photos:[]},
{n:‚ÄúEldorado Park‚Äù,a:‚Äú17206 E. Brown Cir.‚Äù,ac:8.4,f:{playground:1,shelter:1},photos:[]},
{n:‚ÄúExpo Park‚Äù,a:‚Äú10955 E. Exposition Ave.‚Äù,ac:57.3,f:{tennis:1,playground:1,basketball:1,baseball:1,disc_golf:1,trails:1},photos:[]},
{n:‚ÄúFairplay Park‚Äù,a:‚Äú2200 N. Altura Blvd.‚Äù,ac:1,f:{playground:1,basketball:1},photos:[]},
{n:‚ÄúFlanders Park‚Äù,a:‚Äú3051 S. Flanders St.‚Äù,ac:3.1,f:{playground:1,trails:1,shelter:1},photos:[]},
{n:‚ÄúFletcher Park‚Äù,a:‚Äú1100 N. Akron St.‚Äù,ac:0.3,f:{playground:1},photos:[]},
{n:‚ÄúFletcher Plaza‚Äù,a:‚Äú9800 E. Colfax Ave.‚Äù,ac:0.3,f:{garden:1},photos:[]},
{n:‚ÄúFreedom Park‚Äù,a:‚Äú13697 E. 13th Ave.‚Äù,ac:0.2,f:{playground:1},photos:[]},
{n:‚ÄúFulton Park‚Äù,a:‚Äú9920 E. 8th Ave.‚Äù,ac:8.5,f:{tennis:1,playground:1,basketball:1,baseball:1,garden:1},photos:[]},
{n:‚ÄúGenerals Park‚Äù,a:‚Äú1561 N. Quentin St.‚Äù,ac:8.3,f:{playground:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúGolden Eagle Park‚Äù,a:‚Äú23611 E. Plymouth Dr.‚Äù,ac:5.2,f:{playground:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúGrandview Dog Park‚Äù,a:‚Äú17500 E. Quincy Ave.‚Äù,ac:5.7,f:{dog_park:1},photos:[]},
{n:‚ÄúGreat Plains Park‚Äù,a:‚Äú20100 E. Jewell Ave.‚Äù,ac:54.5,f:{playground:1,basketball:1,baseball:1,soccer:1,trails:1,restroom:1,shelter:1,sprayground:1},photos:[]},
{n:‚ÄúHampden Run Park‚Äù,a:‚Äú3501 S. Uravan St.‚Äù,ac:1.4,f:{playground:1,trails:1},photos:[]},
{n:‚ÄúHavana Heights Park‚Äù,a:‚Äú10901 E. Warren Ave.‚Äù,ac:2.1,f:{tennis:1,playground:1,basketball:1},photos:[]},
{n:‚ÄúHavana Heights Pond Park‚Äù,a:‚Äú11050 E. Jewell Ave.‚Äù,ac:2,f:{},photos:[]},
{n:‚ÄúHavana Park‚Äù,a:‚Äú10600 E. 11th Ave.‚Äù,ac:4.1,f:{playground:1},photos:[]},
{n:‚ÄúHighland Hollows Park‚Äù,a:‚Äú1400 S. Uravan St.‚Äù,ac:12.7,f:{pickleball:1,playground:1,basketball:1,volleyball:1,shelter:1},photos:[]},
{n:‚ÄúHighline Park & Ballfields‚Äù,a:‚Äú70 N. Peoria St.‚Äù,ac:30.9,f:{playground:1,baseball:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúHilltop Park‚Äù,a:‚Äú3242 S. Richfield St.‚Äù,ac:8,f:{tennis:1,playground:1,basketball:1,shelter:1},photos:[]},
{n:‚ÄúHoffman Park‚Äù,a:‚Äú12651 E. 7th Ave.‚Äù,ac:11,f:{playground:1,basketball:1,baseball:1,shelter:1},photos:[]},
{n:‚ÄúHomestead Park‚Äù,a:‚Äú23945 E. Florida Ave.‚Äù,ac:7.1,f:{playground:1,soccer:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúHoops Park‚Äù,a:‚Äú16300 E. 6th Ave.‚Äù,ac:1.4,f:{basketball:1,restroom:1},photos:[]},
{n:‚ÄúHorizon Park‚Äù,a:‚Äú3901 S. Reservoir Rd.‚Äù,ac:3.9,f:{tennis:1},photos:[]},
{n:‚ÄúHorseshoe Park‚Äù,a:‚Äú2125 S. Kittredge Way‚Äù,ac:10.6,f:{playground:1,baseball:1,trails:1,restroom:1},photos:[]},
{n:‚ÄúJewell Park‚Äù,a:‚Äú12200 E. 13th Pl.‚Äù,ac:1.2,f:{playground:1,basketball:1},photos:[]},
{n:‚ÄúJewell Wetlands‚Äù,a:‚Äú13005 E. Jewell Ave.‚Äù,ac:46.3,f:{trails:1,restroom:1},photos:[]},
{n:‚ÄúKalispell Park Ballfields‚Äù,a:‚Äú15901 E. Pheasant Run Pkwy.‚Äù,ac:6.3,f:{baseball:1},photos:[]},
{n:‚ÄúKestrel Point Natural Area‚Äù,a:‚Äú24407 E. Frost Dr.‚Äù,ac:5,f:{trails:1},photos:[]},
{n:‚ÄúKingsborough Park‚Äù,a:‚Äú1466 S. Idalia St.‚Äù,ac:0.6,f:{playground:1,trails:1},photos:[]},
{n:‚ÄúLa Parquita Park‚Äù,a:‚Äú4040 S. Mission Pkwy.‚Äù,ac:3.3,f:{tennis:1,trails:1},photos:[]},
{n:‚ÄúLarkspur Park‚Äù,a:‚Äú22551 E. Davies Dr.‚Äù,ac:7,f:{playground:1,trails:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúLos Ninos Park‚Äù,a:‚Äú15800 E. Mansfield Dr.‚Äù,ac:2.3,f:{playground:1},photos:[]},
{n:‚ÄúLowry Park‚Äù,a:‚Äú1001 N. Dayton St.‚Äù,ac:33.1,f:{playground:1,volleyball:1,shelter:1},photos:[]},
{n:‚ÄúMarina Park‚Äù,a:‚Äú18025 E. Grand Ave.‚Äù,ac:14.3,f:{baseball:1},photos:[]},
{n:‚ÄúMcMullen Park‚Äù,a:‚Äú200 N. Dayton St.‚Äù,ac:3.6,f:{playground:1},photos:[]},
{n:‚ÄúMeadow Hills Golf Course‚Äù,a:‚Äú3609 S. Dawson St.‚Äù,ac:134.1,f:{tennis:1,pool:1,golf:1,restroom:1},photos:[]},
{n:‚ÄúMeadowood Park‚Äù,a:‚Äú3054 S. Laredo St.‚Äù,ac:10.7,f:{tennis:1,playground:1,basketball:1,baseball:1,trails:1,restroom:1},photos:[]},
{n:‚ÄúMission Viejo Park‚Äù,a:‚Äú3999 S. Mission Pkwy.‚Äù,ac:21.4,f:{playground:1,baseball:1,trails:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúMontview Park‚Äù,a:‚Äú1901 N. Chester St.‚Äù,ac:8.9,f:{playground:1,basketball:1,shelter:1,garden:1},photos:[]},
{n:‚ÄúMoorhead Park‚Äù,a:‚Äú2390 N. Havana St.‚Äù,ac:4.5,f:{playground:1,basketball:1,shelter:1},photos:[]},
{n:‚ÄúMountain View Park‚Äù,a:‚Äú17200 E. Kentucky Ave.‚Äù,ac:4.3,f:{playground:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúMurphy Creek Golf Course‚Äù,a:‚Äú1700 S. Old Tom Morris Rd.‚Äù,ac:272.9,f:{golf:1},photos:[]},
{n:‚ÄúNome Park‚Äù,a:‚Äú1200 N. Nome St.‚Äù,ac:0.8,f:{playground:1,garden:1},photos:[]},
{n:‚ÄúNorfolk Glen Park‚Äù,a:‚Äú15800 E. 17th Pl.‚Äù,ac:1.6,f:{playground:1,trails:1,shelter:1},photos:[]},
{n:‚ÄúOlympic Neighborhood Park‚Äù,a:‚Äú15775 E. Yale Ave.‚Äù,ac:5.3,f:{playground:1,trails:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúOlympic Park Ballfields‚Äù,a:‚Äú15501 E. Yale Ave.‚Äù,ac:26.1,f:{baseball:1,trails:1,restroom:1},photos:[]},
{n:‚ÄúOlympic Park Volleyball‚Äù,a:‚Äú2465 S. Wheel Park Cir.‚Äù,ac:4.7,f:{volleyball:1,trails:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúPagosa Park‚Äù,a:‚Äú17201 E. Brown Cir.‚Äù,ac:2.3,f:{playground:1},photos:[]},
{n:‚ÄúPanorama Park‚Äù,a:‚Äú17400 E. Arizona Ave.‚Äù,ac:4.3,f:{pickleball:1,tennis:1,playground:1},photos:[]},
{n:‚ÄúParklane Park‚Äù,a:‚Äú13003 E. 30th Ave.‚Äù,ac:4.2,f:{pool:1,trails:1,shelter:1},photos:[]},
{n:‚ÄúPeoria Hills Park‚Äù,a:‚Äú12401 E. Florida Ave.‚Äù,ac:9.5,f:{playground:1},photos:[]},
{n:‚ÄúPheasant Run Park‚Äù,a:‚Äú14971 E. Pheasant Run Pkwy.‚Äù,ac:4.6,f:{tennis:1,playground:1,pool:1},photos:[]},
{n:‚ÄúPlains Conservation Center‚Äù,a:‚Äú21901 E. Hampden Ave.‚Äù,ac:1182.5,f:{trails:1,restroom:1},photos:[]},
{n:‚ÄúPonderosa Preserve‚Äù,a:‚Äú8150 S. Coolidge Way‚Äù,ac:68.6,f:{},photos:[]},
{n:‚ÄúPronghorn Natural Area‚Äù,a:‚Äú27800 E. Quincy Ave.‚Äù,ac:848.4,f:{},photos:[]},
{n:‚ÄúQuincy Reservoir‚Äù,a:‚Äú18350 E. Quincy Ave.‚Äù,ac:288.7,f:{fishing:1,trails:1,boating:1},photos:[]},
{n:‚ÄúRed-tailed Hawk Park‚Äù,a:‚Äú23701 E. Hinsdale Way‚Äù,ac:35,f:{playground:1,baseball:1,volleyball:1,trails:1,restroom:1,shelter:1,sprayground:1},photos:[]},
{n:‚ÄúRocky Ridge Park‚Äù,a:‚Äú16200 E. Mississippi Ave.‚Äù,ac:13.3,f:{playground:1,basketball:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúSaddle Rock Golf Course‚Äù,a:‚Äú21705 E. Arapahoe Rd.‚Äù,ac:233.6,f:{golf:1},photos:[]},
{n:‚ÄúSagebrush Park‚Äù,a:‚Äú4744 S. Evanston Way‚Äù,ac:17.7,f:{playground:1,shelter:1},photos:[]},
{n:‚ÄúSand Creek Park‚Äù,a:‚Äú2700 N. Peoria St.‚Äù,ac:85.6,f:{trails:1},photos:[]},
{n:‚ÄúSand Creek Riparian Preserve‚Äù,a:‚Äú20809 E. 6th Ave.‚Äù,ac:531.6,f:{trails:1},photos:[]},
{n:‚ÄúSettlers Park‚Äù,a:‚Äú14800 E. Walsh Dr.‚Äù,ac:8,f:{playground:1,basketball:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúSeven Hills Park‚Äù,a:‚Äú3000 S. Ceylon Way‚Äù,ac:7,f:{pickleball:1,playground:1,baseball:1,soccer:1,trails:1},photos:[]},
{n:‚ÄúSidecreek Park‚Äù,a:‚Äú19001 E. Colorado Dr.‚Äù,ac:12.8,f:{tennis:1,playground:1,basketball:1,shelter:1},photos:[]},
{n:‚ÄúSingletree Park‚Äù,a:‚Äú19590 E. 58th Ave.‚Äù,ac:6.5,f:{playground:1,basketball:1,dog_park:1,shelter:1},photos:[]},
{n:‚ÄúSoccer Skills Area‚Äù,a:‚Äú20101 E. Hampden Ave.‚Äù,ac:10.2,f:{soccer:1,trails:1},photos:[]},
{n:‚ÄúSpencer Garrett Park‚Äù,a:‚Äú11008 E. 17th Ave.‚Äù,ac:6.4,f:{playground:1,basketball:1,restroom:1,shelter:1,garden:1},photos:[]},
{n:‚ÄúSports Park‚Äù,a:‚Äú19300 E. Colfax Ave.‚Äù,ac:249.8,f:{playground:1,baseball:1,soccer:1,trails:1,restroom:1},photos:[]},
{n:‚ÄúSpringhill Golf Course‚Äù,a:‚Äú800 N. Telluride St.‚Äù,ac:112.3,f:{golf:1},photos:[]},
{n:‚ÄúSpringhill Park‚Äù,a:‚Äú810 N. Telluride St.‚Äù,ac:29.3,f:{playground:1,pool:1,trails:1,shelter:1},photos:[]},
{n:‚ÄúStar K Ranch‚Äù,a:‚Äú16002 E. Smith Rd.‚Äù,ac:242.5,f:{trails:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúSummer Valley Park‚Äù,a:‚Äú17400 E. Lehigh Pl.‚Äù,ac:8.1,f:{playground:1,trails:1},photos:[]},
{n:‚ÄúSunburst Park‚Äù,a:‚Äú4401 S. Memphis St.‚Äù,ac:2.9,f:{playground:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúSunrise Park‚Äù,a:‚Äú3960 S. Genoa Way‚Äù,ac:23,f:{tennis:1,playground:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúSwitchgrass Park‚Äù,a:‚Äú2675 S. Conservatory Pkwy.‚Äù,ac:4.3,f:{playground:1,trails:1,shelter:1},photos:[]},
{n:‚ÄúTerrace Park‚Äù,a:‚Äú18801 E. Montview Blvd.‚Äù,ac:6,f:{playground:1,basketball:1,shelter:1},photos:[]},
{n:‚ÄúTierra Park‚Äù,a:‚Äú14777 E. Asbury Ave.‚Äù,ac:14.3,f:{tennis:1,playground:1},photos:[]},
{n:‚ÄúTollgate Crossing Neighborhood Park‚Äù,a:‚Äú24600 E. Belleview Ave.‚Äù,ac:5.5,f:{pickleball:1,tennis:1,playground:1,trails:1,shelter:1},photos:[]},
{n:‚ÄúToll Gate Park‚Äù,a:‚Äú751 S. Kalispell Way‚Äù,ac:7.7,f:{playground:1,trails:1},photos:[]},
{n:‚ÄúTraditions Neighborhood Park‚Äù,a:‚Äú100 S. Jackson Gap Way‚Äù,ac:8.73,f:{playground:1,basketball:1,skate:1,shelter:1},photos:[]},
{n:‚ÄúTriangle Park‚Äù,a:‚Äú1600 N. Espana St.‚Äù,ac:4.5,f:{playground:1,shelter:1},photos:[]},
{n:‚ÄúUpland Park‚Äù,a:‚Äú2800 N. Walden St.‚Äù,ac:1.4,f:{},photos:[]},
{n:‚ÄúUtah Park‚Äù,a:‚Äú1800 S. Peoria St.‚Äù,ac:46.5,f:{tennis:1,playground:1,baseball:1,pool:1,trails:1,restroom:1,shelter:1},photos:[]},
{n:‚ÄúVillage East Park‚Äù,a:‚Äú1400 S. Moline St.‚Äù,ac:5.9,f:{playground:1,baseball:1,trails:1},photos:[]},
{n:‚ÄúVillage Green Park‚Äù,a:‚Äú1300 S. Chambers Cir.‚Äù,ac:8.2,f:{tennis:1,playground:1,pool:1,restroom:1},photos:[]},
{n:‚ÄúVirginia Court Park‚Äù,a:‚Äú433 S. Troy St.‚Äù,ac:5,f:{baseball:1},photos:[]},
{n:‚ÄúWagon Trail Park‚Äù,a:‚Äú16550 E. Pheasant Run Pkwy.‚Äù,ac:5.1,f:{playground:1},photos:[]},
{n:‚ÄúWheel Park‚Äù,a:‚Äú2500 S. Wheel Park Cir.‚Äù,ac:25.3,f:{trails:1,restroom:1,shelter:1,skate:1},photos:[]},
{n:‚ÄúWheeling Park‚Äù,a:‚Äú475 S. Potomac Way‚Äù,ac:7.3,f:{baseball:1,soccer:1},photos:[]},
{n:‚ÄúWillow Bend Park‚Äù,a:‚Äú20646 E. Eastman Ave.‚Äù,ac:0.3,f:{playground:1,trails:1,shelter:1},photos:[]},
];

const FILTERS = [
{k:‚Äòplayground‚Äô,l:‚ÄòPlayground‚Äô,e:‚Äôüõù‚Äô},
{k:‚Äòpickleball‚Äô,l:‚ÄòPickleball‚Äô,e:‚Äôüèì‚Äô},
{k:‚Äòtennis‚Äô,l:‚ÄòTennis‚Äô,e:‚Äôüéæ‚Äô},
{k:‚Äòbasketball‚Äô,l:‚ÄòBasketball‚Äô,e:‚ÄôüèÄ‚Äô},
{k:‚Äòbaseball‚Äô,l:‚ÄòBaseball/Softball‚Äô,e:‚Äô‚öæ‚Äô},
{k:‚Äòsoccer‚Äô,l:‚ÄòSoccer‚Äô,e:‚Äô‚öΩ‚Äô},
{k:‚Äòvolleyball‚Äô,l:‚ÄòVolleyball‚Äô,e:‚Äôüèê‚Äô},
{k:‚Äòpool‚Äô,l:‚ÄòPool‚Äô,e:‚Äôüèä‚Äô},
{k:‚Äòsprayground‚Äô,l:‚ÄòSprayground‚Äô,e:‚Äôüí¶‚Äô},
{k:‚Äòdog_park‚Äô,l:‚ÄòDog Park‚Äô,e:‚Äôüêï‚Äô},
{k:‚Äòtrails‚Äô,l:‚ÄòTrails‚Äô,e:‚Äôü•æ‚Äô},
{k:‚Äòfishing‚Äô,l:‚ÄòFishing‚Äô,e:‚Äôüé£‚Äô},
{k:‚Äòdisc_golf‚Äô,l:‚ÄòDisc Golf‚Äô,e:‚Äôü•è‚Äô},
{k:‚Äòskate‚Äô,l:‚ÄòSkate/BMX‚Äô,e:‚Äôüõπ‚Äô},
{k:‚Äògolf‚Äô,l:‚ÄòGolf Course‚Äô,e:‚Äô‚õ≥‚Äô},
{k:‚Äògarden‚Äô,l:‚ÄòCommunity Garden‚Äô,e:‚Äôüå±‚Äô},
{k:‚Äòboating‚Äô,l:‚ÄòBoating‚Äô,e:‚Äôüö£‚Äô},
{k:‚Äòrestroom‚Äô,l:‚ÄòRestrooms‚Äô,e:‚Äôüöª‚Äô},
{k:‚Äòshelter‚Äô,l:‚ÄòShelter‚Äô,e:‚ÄôüèïÔ∏è‚Äô},
];

const grid = document.getElementById(‚Äògrid‚Äô);
const searchEl = document.getElementById(‚Äòsearch‚Äô);
const sortEl = document.getElementById(‚Äòsort‚Äô);
const filterBar = document.getElementById(‚Äòfilter-bar‚Äô);
const meta = document.getElementById(‚Äòmeta‚Äô);
const emptyEl = document.getElementById(‚Äòempty‚Äô);
const badge = document.getElementById(‚Äòshown-badge‚Äô);
document.getElementById(‚Äòtot‚Äô).textContent = P.length;

let active = new Set();
window._activeSet = active;

FILTERS.forEach(f => {
const b = document.createElement(‚Äòbutton‚Äô);
b.className = ‚Äòpill‚Äô; b.dataset.k = f.k;
b.innerHTML = f.e + ‚Äô ‚Äô + f.l;
b.onclick = () => { active.has(f.k) ? active.delete(f.k) : active.add(f.k); b.classList.toggle(‚Äòon‚Äô); render(); };
filterBar.appendChild(b);
});
const resetBtn = document.createElement(‚Äòbutton‚Äô);
resetBtn.className = ‚Äòpill reset‚Äô; resetBtn.textContent = ‚Äòx Clear‚Äô;
resetBtn.onclick = () => {
active.clear();
document.querySelectorAll(‚Äô.pill.on‚Äô).forEach(b => b.classList.remove(‚Äòon‚Äô));
searchEl.value = ‚Äò‚Äô; render();
};
filterBar.appendChild(resetBtn);

function createGallery(park, idx) {
const div = document.createElement(‚Äòdiv‚Äô);
div.className = ‚Äòphoto-gallery‚Äô;
const photos = park.photos || [];
const grads = [[‚Äô#d4ead9‚Äô,‚Äô#c8dff0‚Äô],[‚Äô#c8dff0‚Äô,‚Äô#d4ead9‚Äô],[‚Äô#e8d5c0‚Äô,‚Äô#d4ead9‚Äô],[‚Äô#d4ead9‚Äô,‚Äô#e8d5c0‚Äô],[‚Äô#c8e8d4‚Äô,‚Äô#b8d4e8‚Äô],[‚Äô#e8e0d4‚Äô,‚Äô#c8ead4‚Äô],[‚Äô#d8e8c8‚Äô,‚Äô#c0d8e8‚Äô],[‚Äô#e0d8c8‚Äô,‚Äô#d0e8d0‚Äô]];
const icons = [‚Äôüå≤‚Äô,‚Äôüå≥‚Äô,‚ÄôüåûÔ∏è‚Äô,‚Äôüåø‚Äô,‚ÄôüçÉ‚Äô,‚Äô‚õ≤‚Äô,‚Äôüåª‚Äô,‚Äôüåæ‚Äô,‚ÄôüèïÔ∏è‚Äô,‚ÄôüåÑ‚Äô];
const [c1, c2] = grads[idx % grads.length];
const icon = icons[idx % icons.length];

const passportBtn = document.createElement(‚Äòbutton‚Äô);
passportBtn.className = ‚Äòpassport-btn‚Äô + (visited.has(park.n) ? ‚Äô stamped‚Äô : ‚Äò‚Äô);
passportBtn.innerHTML = visited.has(park.n) ? ‚Äò‚úì Visited‚Äô : ‚ÄòüèïÔ∏è Check In‚Äô;
passportBtn.onclick = e => {
e.preventDefault();
if (visited.has(park.n)) { visited.delete(park.n); passportBtn.className = ‚Äòpassport-btn‚Äô; passportBtn.innerHTML = ‚ÄòüèïÔ∏è Check In‚Äô; }
else { visited.add(park.n); passportBtn.className = ‚Äòpassport-btn stamped‚Äô; passportBtn.innerHTML = ‚Äò‚úì Visited‚Äô; }
saveVisited();
};
div.appendChild(passportBtn);

if (COORDS[park.n]) {
const mapBtn = document.createElement(‚Äòbutton‚Äô);
mapBtn.className = ‚Äòmap-pin-btn‚Äô;
mapBtn.innerHTML = ‚Äòüìç Map‚Äô;
mapBtn.onclick = e => { e.preventDefault(); focusMapOnPark(park.n); };
div.appendChild(mapBtn);
}

if (!photos.length) {
const ph = document.createElement(‚Äòdiv‚Äô);
ph.className = ‚Äòplaceholder‚Äô;
ph.style.background = ‚Äòlinear-gradient(135deg,‚Äô + c1 + ‚Äô 0%,‚Äô + c2 + ‚Äô 100%)‚Äô;
ph.innerHTML = ‚Äò<div class="placeholder-icon">‚Äô + icon + ‚Äò</div><div class="placeholder-text">Photo coming soon</div>‚Äô;
div.appendChild(ph);
} else {
let cur = 0;
const imgEl = document.createElement(‚Äòimg‚Äô);
imgEl.className = ‚Äòpark-photo‚Äô; imgEl.src = photos[0]; imgEl.alt = park.n;
div.appendChild(imgEl);
}
return div;
}

function render() {
const q = searchEl.value.trim().toLowerCase();
const s = sortEl.value;
const af = [‚Ä¶active];

let list = P.map((p, origIdx) => {
const matchSearch = !q || p.n.toLowerCase().includes(q) || p.a.toLowerCase().includes(q);
const score = af.length ? af.filter(k => p.f[k]).length : null;
const c = COORDS[p.n];
const dist = (userLat && c) ? haversine(userLat, userLng, c[0], c[1]) : null;
return { ‚Ä¶p, score, matchSearch, origIdx, dist };
}).filter(p => p.matchSearch);

if (af.length) list.sort((a,b) => b.score - a.score);
else if (s === ‚Äòalpha‚Äô) list.sort((a,b) => a.n.localeCompare(b.n));
else if (s === ‚Äòbig‚Äô) list.sort((a,b) => b.ac - a.ac);
else if (s === ‚Äòvisited‚Äô) list.sort((a,b) => (visited.has(b.n)?1:0)-(visited.has(a.n)?1:0));
else if (s === ‚Äònearest‚Äô) {
if (userLat) list.sort((a,b) => (a.dist||9999)-(b.dist||9999));
else {
sortEl.value=‚Äòalpha‚Äô; list.sort((a,b)=>a.n.localeCompare(b.n));
const errMsg = document.getElementById(‚Äòlocate-error‚Äô);
if (errMsg) { errMsg.textContent = ‚Äò‚ö†Ô∏è Click ‚ÄúFind me‚Äù first to sort by distance‚Äô; errMsg.style.display = ‚Äòinline‚Äô; setTimeout(() => { errMsg.style.display = ‚Äònone‚Äô; errMsg.textContent = ‚Äò‚ö†Ô∏è Location access denied ‚Äî enable in browser settings‚Äô; }, 3500); }
}
}
else list.sort((a,b) => a.ac - b.ac);

currentFiltered = list;
badge.textContent = list.length + ‚Äô shown‚Äô;

if (!af.length) {
meta.textContent = q ? list.length + ‚Äô of ‚Äô + P.length + ‚Äô match ‚Äú‚Äô + q + ‚Äò‚Äù‚Äô : ‚ÄòShowing all ‚Äô + P.length + ‚Äô parks & open spaces‚Äô;
} else {
const perfect = list.filter(p => p.score === af.length).length;
const partial = list.filter(p => p.score > 0 && p.score < af.length).length;
meta.textContent = perfect
? perfect + ‚Äô park‚Äô + (perfect!==1?‚Äòs‚Äô:‚Äô‚Äô) + ‚Äô match all ‚Äô + af.length + ‚Äô filter‚Äô + (af.length!==1?‚Äòs‚Äô:‚Äô‚Äô) + (partial?‚Äô ¬∑ ‚Äò+partial+‚Äô partial‚Äô:‚Äô‚Äô) + ‚Äô ¬∑ best match order‚Äô
: partial ? ‚ÄòNo perfect matches ‚Äî ‚Äô + partial + ‚Äô partial‚Äô : ‚ÄòNo parks match your filters‚Äô;
}

renderMarkers(list);
grid.innerHTML = ‚Äò‚Äô;
emptyEl.style.display = list.length ? ‚Äònone‚Äô : ‚Äò‚Äô;
if (!list.length) return;

list.forEach((p, i) => {
const amenities = FILTERS.filter(f => p.f[f.k]);
const isPerfect = af.length && p.score === af.length;
const isPartial = af.length && p.score > 0 && p.score < af.length;
const isNone = af.length && p.score === 0;
const tagsHtml = amenities.length
? amenities.map(f => ‚Äò<span class="tag' + (active.has(f.k)?' hi':'') + '">‚Äô + f.e + ‚Äô ‚Äô + f.l + ‚Äò</span>‚Äô).join(‚Äô‚Äô)
: ‚Äò<span class="tag none">Open space</span>‚Äô;
const matchBadge = af.length
? isPerfect ? ‚Äò<div class="match-badge perfect">‚úì ‚Äô + p.score + ‚Äò/‚Äô + af.length + ‚Äò</div>‚Äô
: isPartial ? ‚Äò<div class="match-badge partial">‚Äô + p.score + ‚Äò/‚Äô + af.length + ‚Äò</div>‚Äô
: ‚Äò<div class="match-badge none-match">0/‚Äô + af.length + ‚Äò</div>‚Äô : ‚Äò‚Äô;
const mapUrl = ‚Äòhttps://www.google.com/maps/search/?api=1&query=‚Äô + encodeURIComponent(p.n+‚Äô Aurora CO‚Äô);
const cityUrl = ‚Äòhttps://www.auroragov.org/things_to_do/parks__open_space___trails/park_listings‚Äô;
const acStr = p.ac > 0 ? p.ac.toLocaleString() + ‚Äô ac‚Äô : ‚Äò‚Äô;
const distStr = p.dist ? ‚Äô<span style="font-size:11px;color:#b07848;font-weight:500">üìç ‚Äô + distLabel(p.dist) + ‚Äò</span>‚Äô : ‚Äò‚Äô;

```
const card = document.createElement('div');
card.className = 'card' + (isNone?' dimmed':'');
card.style.animationDelay = Math.min(i,25)*16 + 'ms';
card.appendChild(createGallery(p, p.origIdx));
const body = document.createElement('div');
body.className = 'card-body';
body.innerHTML =
  '<div class="card-head">' +
    '<div class="park-name">' + p.n + '</div>' +
    '<div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px;flex-shrink:0">' +
      (acStr ? '<div class="acres">' + acStr + '</div>' : '') + matchBadge +
    '</div>' +
  '</div>' +
  '<div class="addr">' +
    '<svg width="11" height="11" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/><circle cx="12" cy="10" r="3"/></svg>' +
    p.a + ', Aurora CO ' + distStr +
  '</div>' +
  '<div class="tags">' + tagsHtml + '</div>' +
  '<div class="card-actions">' +
    '<a href="' + mapUrl + '" target="_blank" class="dir-btn">' +
      '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg>' +
      'Get Directions' +
    '</a>' +
    '<a href="' + cityUrl + '" target="_blank" class="city-btn">&#x1F3DB;&#xFE0F; City Site</a>' +
  '</div>';
card.appendChild(body);
grid.appendChild(card);
```

});
}

updatePassport();
render();
searchEl.addEventListener(‚Äòinput‚Äô, render);
sortEl.addEventListener(‚Äòchange‚Äô, render);

// Dynamically load Leaflet so it works in all contexts
(function() {
var script = document.createElement(‚Äòscript‚Äô);
script.src = ‚Äòhttps://unpkg.com/leaflet@1.9.4/dist/leaflet.js‚Äô;
script.onload = function() { initMap(); renderMarkers(currentFiltered); };
script.onerror = function() {
document.getElementById(‚Äòmap‚Äô).innerHTML = ‚Äò<div style="display:flex;align-items:center;justify-content:center;height:100%;color:#aaa;font-size:13px;">Map unavailable ‚Äî check your connection</div>‚Äô;
};
document.head.appendChild(script);
})();
</script>

</body>
</html>
  